global
        uid haproxy
        gid haproxy
        daemon

listen http 0.0.0.0:80
        <% @pool_members.each do |member| -%>
	server <%= member[:hostname] %> <%= member[:network][:interfaces][:eth1][:addresses].select { |address, data| data[:family] == 'inet' }.keys[0]  %>
	<% end -%>  

<% if node["haproxy"]["enable_admin"] -%>
listen admin 0.0.0.0:<%= @admin["port"] %>
	mode http
	stats uri /
	stats auth <%= @admin["username"] %>:<%= @admin["password"] %>
<% end -%>

